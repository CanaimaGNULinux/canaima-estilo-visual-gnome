#!/bin/bash -e
#
# ==============================================================================
# PAQUETE: canaima-estilo-visual
# ARCHIVO: preinst
# DESCRIPCIÓN: Configura el sistema antes de la instalación del paquete.
# COPYRIGHT:
#  (C) 2010 Luis Alejandro Martínez Faneyth <martinez.faneyth@gmail.com>
#  (C) 2010 Diego Alberto Aguilera Zambrano <daguilera85@gmail.com>
#  (C) 2010 Carlos Alejandro Guerrero Mora <guerrerocarlos@gmail.com>
#  (C) 2010 Francisco Javier Vásquez Guerrero <franjvasquezg@gmail.com>
# LICENCIA: GPL3
# ==============================================================================
#
# Este programa es software libre. Puede redistribuirlo y/o modificarlo bajo los
# términos de la Licencia Pública General de GNU (versión 3).

PKG="canaima-estilo-visual"

case ${1} in

        install|upgrade)

                # ================================================================
                # Limpieza de configuraciones anteriores y residuos de Canaima 2.1
                # ================================================================

		if [ "$(dpkg-query -s ${PKG} | grep Status)" == "Status: install ok installed" ] && [ "$(dpkg-query -s ${PKG} | grep 'Version: 2.')" != '' ]
		then

			dpkg-divert --package ${PKG} --remove --rename --divert /var/lib/${PKG}/diverts/gtkrc /usr/share/themes/Clearlooks/gtk-2.0/gtkrc
			dpkg-divert --package ${PKG} --remove --rename --divert /var/lib/${PKG}/diverts/grub /etc/default/grub

	                if [ -e /etc/grub.d/05_debian_theme ] || [ -e /etc/grub.d/10_linux ]
        	        then

                	        echo "===== Limpiando configuraciones del /etc/grub.d/ de Canaima 2.1 ====="
                        	rm -f /etc/grub.d/05_debian_theme
				rm -f /etc/grub.d/10_linux

        	        fi

                	if [ -e /usr/lib/mime/packages/openoffice.org-calc ] || [ -e /usr/lib/mime/packages/openoffice.org-impress ] || [ -e /usr/lib/mime/packages/openoffice.org-writer ]
			then

	                        echo "===== Limpiando /usr/lib/mime/packages/ de Canaima 2.1 ====="
        	                rm -f /usr/lib/mime/packages/openoffice.org-calc
				rm -f /usr/lib/mime/packages/openoffice.org-impress
				rm -f /usr/lib/mime/packages/openoffice.org-writer

			fi

			if [ -e /usr/share/themes/Clearlooks ] || [ -e /usr/share/splashy ] || [ -e /usr/share/doc/canaima-estilo-visual ] || [ -e /usr/share/canaima-estilo-visual ]
			then

				echo "===== Limpiando /usr/share/canaima-estilo-visual de Canaima 2.1 ====="
				rm -rf /usr/share/themes/Clearlooks/
				rm -rf /usr/share/splashy/
				rm -rf /usr/share/doc/canaima-estilo-visual/
				rm -rf /usr/share/canaima-estilo-visual/

			fi

			if [ -e /usr/share/gconf/defaults/90_canaima* ]
			then

				echo "===== Limpiando /usr/share/gconf/defaults/ de Canaima 2.1 ====="
				rm -rf /usr/share/gconf/defaults/90_canaima*

			fi


		fi
	;;

        abort-upgrade)
        ;;

        *)
                echo "preinst no reconoce el argumento '"${1}"'" >&2
                exit 1
        ;;

esac

#DEBHELPER#

exit 0
